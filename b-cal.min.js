/**
 * @page        http://github.com/Shushik/b-cal/
 * @author      Shushik <silkleopard@yandex.ru>
 * @version     2.0
 * @description a simple javascript calendar
 *
 * @constructor
 *
 * @this    {Cal}
 * @param   {DOMNode}
 * @param   {DOMNode}
 * @param   {Object}
 * @param   {Object}
 * @returns {Cal}
 */
;Cal=function(){function g(a,c,b,d){arguments&&1<arguments.length&&this.init(a,c,b,d);return this}g.prototype={_lang:null,_holidays:[],_default:{tmpl:{hat:"{{ month.full }} {{ year.full }}",prev:"{{ month.full }} {{ year.full }}",next:"{{ month.full }} {{ year.full }}",stdout:"{{ day.num }} {{ month.part }}",mirror:"{{ year.full }}-{{ month.nums }}-{{ day.nums }}"},lang:{hide:"Hide",prev:"",next:"",plural:{day:["days","day","day"]},weekdays:{full:"Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "), part:"Mo Tu We Th Fr Sa Su".split(" ")},monthes:{full:"January February March April May June July August September October November December".split(" "),decl:"January February March April May June July August September October November December".split(" "),part:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")}}},init:function(a,c,b,d){var b=b||{},d=d||{},e="",f=this._default.tmpl,k=new Date,h=null,i=null;this._hold=this.shown=!1;g.lang(b.lang);c&&(this._way=c.innerHTML?"innerHTML":"value"); b.tmpl||(b.tmpl={});for(e in f)b.tmpl[e]||(b.tmpl[e]=f[e]);b.min_date?"string"==typeof b.min_date&&(b.min_date=g.parse(b.min_date)):b.min_date=new Date(k);this._min=new Date(b.min_date);this._min.setDate(this._min.getDate()-1);b.now_date?"string"==typeof b.now_date&&(b.now_date=g.parse(b.now_date)):b.now_date=new Date(k);this._now=b.now_date;b.max_date?"string"==typeof b.max_date&&(b.max_date=g.parse(b.max_date)):(b.max_date=new Date(k),b.max_date.setYear(k.getFullYear()+1));this._max=new Date(b.max_date); this._max.setDate(this._max.getDate()+1);this._data={prev:null,curr:null,next:null};this._nodes={days:null,prev:null,next:null,week:null,items:{list:[]},block:null,field:c,target:a,chosen:{alias:"",node:null},clicked:{alias:"",node:null}};i=b.default_stdout?b.default_stdout:k;this._nodes.field&&("string"==typeof i&&(i=g.parse(i)),h=g.human(i),this._nodes.field[this._way]=this._tmpl(b.tmpl.stdout,h),this._nodes.chosen.alias=i.getFullYear()+"-"+i.getMonth()+"-"+i.getDate(),this._nodes.field.setAttribute("data-day", i.getDate()),this._nodes.field.setAttribute("data-year",i.getFullYear()),this._nodes.field.setAttribute("data-month",i.getMonth()),b.mirror&&(b.mirror[this._way]=this._tmpl(b.tmpl.mirror,h)));this._tangled=null;this._events=[];this._params={};for(e in b)"lang"!=e&&(this._params[e]=b[e]);this._handlers=d;this._install();return this},uninstall:function(){var a=this._events.length,c=null,b=this._nodes.block,d=this._nodes.target;for(pos=0;pos<a;pos++)c=this._events[pos],this._unbind(c.target,c.alias, c.handler);delete this._min;delete this._now;delete this._max;delete this._way;delete this.shown;delete this._hold;delete this._data;delete this._nodes;delete this._events;delete this._params;delete this._tangled;delete this._handlers;delete this.hiddenable;d.removeChild(b);return!0},tangle:function(a,c){this._tangled={instance:a,relation:c};return this},show:function(){var a=null,c=this._nodes.block,a=this._nodes.field,b=this._params.offset_ignore,d=this._offsetize(a,this._nodes.target),a=a&&""!= a[this._way]?new Date(a.getAttribute("data-year"),a.getAttribute("data-month"),a.getAttribute("data-day")):this._params.now_date;this.shown=!0;this._draw(a);!0!==b&&"all"!=b&&("top"!=b&&(c.style.top=d.top+d.height+"px"),"left"!=b&&(c.style.left=d.left+"px"));this._tangled&&this._tangled.instance.hide();this._nodes.block.className+=" b-cal_is_visible";return this},hide:function(){this._nodes.block.className=this._nodes.block.className.replace(" b-cal_is_visible","");this.shown=!1;return this},prev:function(){this._draw(this._data.prev.raw); return this},next:function(){this._draw(this._data.next.raw);return this},jump:function(a){var a=a||!1,c=0,b=0,d=0,c=this._nodes.field[this._way],b=this._min,d=this._max,e=null,e=a instanceof Date?a:g.parse(a?a:c);e<b&&(e=b);e>d&&(e=d);c=e.getDate();b=e.getFullYear();d=e.getMonth();this._nodes.chosen.alias=b+"-"+d+"-"+c;this._draw(e)},max:function(a){"string"==typeof a&&(a=g.parse(a));return a?(this._max=a,this):this._max},now:function(a){"string"==typeof a&&(a=g.parse(a));return a?(this._now=a,this): this._now},min:function(a){"string"==typeof a&&(a=g.parse(a));return a?(this._min=a,this):this._min},reset:function(){var a=this._nodes,c=this._params;this._min=c.min_date;this._now=c.now_date;this._max=c.max_date;g.count(this._now);a.chosen.node&&this.deselect();return this},select:function(){var a=!1,c=0,b=0,d=0,e=null,f=null,k=f=null,h=this._params,i=h.tmpl,j=null,d=this._nodes.chosen.node,e=this._nodes.clicked.node,k=(f=this._tangled)?f.relation:null,j=f?f.instance:null;d&&(d.className=d.className.replace(" b-cal__day_is_chosen", ""));d=this._nodes.chosen.node=e;d.className+=" b-cal__day_is_chosen";c=d.getAttribute("data-day")-0;b=d.getAttribute("data-year")-0;d=d.getAttribute("data-month")-0;e=new Date(b,d,c);this._nodes.chosen.alias=b+"-"+d+"-"+c;f&&(d=j._nodes.chosen.node,i=j._params.tmpl,f=d?new Date(d.getAttribute("data-year"),d.getAttribute("data-month"),d.getAttribute("data-day")):j._now,">"==k?(e>=f&&(a=!0,f=new Date(e),f.setDate(f.getDate()+1)),h.block_range&&j.min(null)):"<"==k&&(e<=f&&(a=!0,f=new Date(e),e.setDate(e.getDate()+ 1)),h.block_range&&j.max(null)),this._range=e,this.hide(),j.jump(f),this._hold&&(this._hold=!1),this._timer&&clearTimeout(this._timer),k=j._nodes.field,j=j._params.mirror,k&&(f=g.human(f),k[this._way]=this._tmpl(i.stdout,f),k.setAttribute("data-day",f.day.num),k.setAttribute("data-year",f.year.full),k.setAttribute("data-month",f.month.num-1),j&&(j.value=this._tmpl(i.mirror,f)),a&&k.focus()));k=this._nodes.field;j=h.mirror;k&&(f=g.human(e),k[this._way]=this._tmpl(i.stdout,f),k.setAttribute("data-day", f.day.num),k.setAttribute("data-year",f.year.full),k.setAttribute("data-month",f.month.num-1),j&&(j.value=this._tmpl(i.mirror,f)));return this},deselect:function(){var a=this._nodes,c=a.items,a=a.chosen.node;a.className=a.className.replace(" b-cal__day_is_chosen","");c.alias="";c.chosen=null;this._tangled&&(this.reset(),this._tangled.instance.reset());return this},order:function(a,c){c=c||!1;a=a.sort(function(a,c){return a>c?1:-1});return"min"==c?a.shift():"max"==c?a.pop():a},parse:function(a){a= a||"";"string"!=typeof a&&"number"!=typeof a&&(a="");var c=0,b=0,d=0,e="",f=[],k=g.prototype,f=k._monthes2replaces(),h=null,i=new Date,j=k._default.lang.monthes.part;switch(a){case "now":case "today":return i;case "yesterday":return new Date(i.getFullYear(),i.getMonth(),i.getDate()-1);case "tomorrow":return new Date(i.getFullYear(),i.getMonth(),i.getDate()+1);case "next month":return new Date(i.getFullYear(),i.getMonth()+1);case "previous month":case "month ago":return new Date(i.getFullYear(),i.getMonth()- 1);case "previous year":case "year ago":return new Date(i.getFullYear()-1,i.getMonth());case "next year":return new Date(i.getFullYear()+1,i.getMonth())}for(e in f)a=a.replace(RegExp("(^|\\s)"+e+"($|\\s)"),"$1"+j[f[e]]+"$2");a.match(/\d{4}/)||(a+=" "+i.getFullYear());h=new Date(a);if(h.getDate())return h;if(a.match(/\d{4}[\s\.,\/-]\d{1,2}[\s\.,\/-]\d{1,2}/))f=a.split(/[\s\.,\/-]/),c=f[2],b=f[0],d=f[1];else if(a.match(/\d{1,2}[\s\.,\/-]\d{1,2}([\s\.,\/-]\d{2,4})?/))f=a.split(/[\s\.,\/-]/),c=f[0],d= f[1],f[2]&&(b=f[2]);else if(f=a.match(RegExp("(\\d{1,2})[\\s\\.,\\/-]("+j.join("|")+")([\\s\\.,\\/-]\\d{4})?.*","i")))c=f[1],b=f[3],d=k._indexof(f[2],j);else if(f=a.match(RegExp("("+j.join("|")+")[\\s\\.,\\/-](\\d{4})?.*","i")))b=f[2],d=k._indexof(f[1],j);else if(f=a.match(RegExp(".*("+j.join("|")+").*(\\d{4})?.*","i")))b=f[2],d=k._indexof(f[1],j);!c||1>c?c=1:2>c.length&&(c="0"+c);d||(d=0);b||(b=i.getFullYear());return new Date(b,d,c)},count:function(a){var a=a||new Date,c=42,b=null,d=null,d=null, e={},b=e.curr={};b.raw=new Date(a);b.day=b.raw.getDate();b.month=b.raw.getMonth();b.year=b.raw.getFullYear();b.till=(new Date(b.year,b.month+1,0)).getDate();b.from=1;b.beg=(new Date(b.year,b.month,1)).getDay();b.end=(new Date(b.year,b.month,b.till)).getDate();0==b.beg&&(b.beg=7);c-=b.till;d=e.prev={};d.raw=new Date(b.year,b.month-1);d.month=d.raw.getMonth();d.year=d.raw.getFullYear();d.till=(new Date(d.year,b.month,0)).getDate();d.from=d.till-(b.beg-2);d.total=d.till-d.from;c-=b.beg;d=e.next={};d.raw= new Date(b.year,b.month+1);d.month=d.raw.getMonth();d.year=d.raw.getFullYear();d.till=c+1;d.from=1;d.total=d.till-d.from;return e},inside:function(a,c,b){return a>c&&a<b?!0:!1},weekend:function(a,c,b){a=(new Date(a-0,c-0,b-0)).getDay();return 0==a||6==a?!0:!1},holiday:function(a,c,b){var b=b+"",a=a+"",d=c+1+"",e=g.prototype._holidays;1==d.length&&(d="0"+d);d=a+""+("-"+d);1==b.length&&(b="0"+b);d+="-"+b;return e?e.length&&-1!=g.prototype._indexof(d,e)?!0:!1:g.weekend(a,c,b)},holidays:function(a){var c= 0,b=0,d="",e=g.prototype._holidays=[];if(a&&a.length){b=a.length;for(c=0;c<b;c++)d=a[c],"object"==typeof d&&(d=d.year+"-"+d.month+"-"+d.day),e.push(d)}return e},lang:function(a){var a=a||{},c="",b=g.prototype,d=b._default.lang;b._lang||(b._lang={});for(c in d)b._lang[c]=a[c]?a[c]:d[c];return b._lang},human:function(a,c){c=c||!1;"string"==typeof a&&(a=g.parse(a));var b=0,b=a.getDate(),d=a.getFullYear(),e=a.getMonth()+1,f=a.getDay(),k=g.prototype,h=k._lang?k._lang:k._default.lang,d={day:{num:b-0,nums:2> (b+"").length?"0"+b:b,week:1>f?7:f,full:"",part:""},year:{full:d,part:(d+"").substring(2),leap:g.leap(d)},month:{num:e,nums:2>(e+"").length?"0"+e:e,days:g.days(a),full:"",decl:"",part:""}};d.year.days=d.year.leap?366:365;b=d.day.week-1;d.day.full=h.weekdays.full[b];d.day.part=h.weekdays.part[b];b=d.month.num-1;d.month.full=h.monthes.full[b];d.month.decl=h.monthes.decl[b];d.month.part=h.monthes.part[b];return"string"==typeof c?k._tmpl(c,d):d},leap:function(a){a instanceof Date&&(a=a.getFullYear()); return 1!=(new Date(a,1,29)).getDate()?!0:!1},days:function(a){!a instanceof Date&&(a=g.parse(a));return(new Date(a.getFullYear(),a.getMonth()+1,0)).getDate()},distance:function(a,c){c=c||new Date;!a instanceof Date&&(a=g.parse(a));!c instanceof Date&&(c=g.parse(c));var b=0,d={days:0,hours:0,weeks:0,years:0,seconds:0,minutes:0,monthes:0};a>c&&(b=c,c=a,a=b);b=12*(c.getFullYear()-a.getFullYear());d.monthes=b-a.getMonth()+c.getMonth();d.years=Math.floor(d.monthes/12);b=c.getTime()-a.getTime();d.seconds= Math.floor(b/1E3);d.minutes=Math.floor(d.seconds/60);d.hours=Math.floor(d.minutes/60);d.days=Math.floor(d.hours/24);d.weeks=Math.floor(d.days/7);return d},_install:function(){var a=0,c=null,b=null,d=null,e=null,f=null,g=this._lang,h=this._nodes,i=this._params;i.no_tail||(b=document.createElement("div"),b.className="b-cal__tail-in",d=document.createElement("div"),d.className="b-cal__tail-out");e=document.createElement("div");e.className="b-cal__hide";e.innerHTML=g.hide;c=h.block=document.createElement("div"); c.className="b-cal";0==document.documentElement.clientHeight&&(c.className+=" b-cal_mode_quirks");i.id&&(c.className+=" b-cal_id_"+i.id);h.prev=document.createElement("div");h.prev.className="b-cal__prev";h.prev.innerHTML=g.prev;h.next=document.createElement("div");h.next.className="b-cal__next";h.next.innerHTML=g.next;h.hat=document.createElement("div");h.hat.className="b-cal__hat";h.days=document.createElement("div");h.days.className="b-cal__days";h.week=document.createElement("div");h.week.className= "b-cal__week";for(a=0;7>a;a++)f=document.createElement("div"),f.className="b-cal__weekday",f.innerHTML=g.weekdays.part[a],h.week.appendChild(f);i.no_tail?c.className+=" b-cal_no_tail":(c.appendChild(d),c.appendChild(b));c.appendChild(h.hat);c.appendChild(h.prev);c.appendChild(h.next);c.appendChild(h.week);c.appendChild(h.days);c.appendChild(e);h.target.appendChild(c);this._alive();return this},_draw:function(a){var c=!1,b=0,d=0,e=0,f=this._min,k=this._max,a=this._data=g.count(a),h=this._params.tmpl, i=this._nodes,j=i.days,l=i.items.list;i.days.innerHTML="";i.hat.innerHTML=g.human(a.curr.raw,h.hat);d=a.prev.year;e=a.prev.month;c=g.inside(new Date(d,e,a.prev.till),f,k);i.prev.title=c?this.human(a.prev.raw,h.prev):"";i.prev.className="b-cal__prev"+(c?"":" b-cal__prev_is_disabled");for(b=a.prev.from;b<=a.prev.till;b++)node=this._day2node(b,e,d,"past",c),j.appendChild(node),l.push(node);d=a.curr.year;e=a.curr.month;for(b=a.curr.from;b<=a.curr.till;b++)c=g.inside(new Date(d,e,b),f,k),node=this._day2node(b, e,d,"presence",c),j.appendChild(node),l.push(node);d=a.next.year;e=a.next.month;i.next.title=c?this.human(a.next.raw,h.next):"";i.next.className="b-cal__next"+(!c?" b-cal__next_is_disabled":"");for(b=a.next.from;b<=a.next.till;b++)node=this._day2node(b,e,d,"future",c),j.appendChild(node),l.push(node)},_day2node:function(a,c,b,d,e){var f="",k=this._tangled?this._tangled.instance._nodes.chosen.alias:"",h=this._nodes.chosen.alias,i=b+"-"+c+"-"+a,j=document.createElement("div");j.className="b-cal__day"; j.innerHTML=a;f=this._now.getFullYear()+"-"+this._now.getMonth()+"-"+this._now.getDate();if("presence"!=d||i==f)j.className+=" b-cal__day_in_"+d;j.className=e?j.className+" b-cal__day_is_enabled":j.className+" b-cal__day_is_disabled";g.holiday(b,c,a)&&(j.className+=" b-cal__day_is_holiday");k&&i==k&&(j.className+=" b-cal__day_is_tangled");h&&i==h&&(j.className+=" b-cal__day_is_chosen",this._nodes.clicked.node=j);j.setAttribute("data-month",c);j.setAttribute("data-year",b);j.setAttribute("data-day", a);return j},_monthes2replaces:function(){var a=0,c=0,b="",d={},a=g.prototype,e=null,f=a._lang&&a._lang.monthes?a._lang.monthes:a._default.lang.monthes;for(b in f){e=f[b];c=e.length;for(a=0;a<c;a++)d[e[a]]=a,d[e[a].toLowerCase()]=a}return d},_alive:function(){var a=this._nodes.block,c=this._nodes.field;c&&(c.setAttribute("autocomplete","off"),this._events.push(this._bind(document,"click",this._proxy(this._click4document,this))),this._events.push(this._bind(document,"keydown",this._proxy(this._keydown4document, this))),this._events.push(this._bind(c,"keydown",this._proxy(this._keydown4field,this))),this._events.push(this._bind(c,"mousedown",this._proxy(this._mousedown4field,this))),this._events.push(this._bind(c,"blur",this._proxy(this._blur4field,this))),this._events.push(this._bind(c,"focus",this._proxy(this._focus4field,this))));this._events.push(this._bind(a,"mousemove",this._proxy(this._mousemove4block,this)));this._events.push(this._bind(a,"mouseout",this._proxy(this._mouseout4block,this)));this._events.push(this._bind(a, "click",this._proxy(this._click4block,this)));return this},_jump:function(a){this.jump(a);this._nodes.clicked.node&&this._nodes.clicked.node.click()},_click4document:function(a){var a=a.target,c=this._nodes.field;!a.className.match("b-cal")&&(c&&a!=c)&&this.hide()},_keydown4document:function(a){27==a.keyCode&&this.shown&&this.hide()},_mousedown4field:function(a){var c=a.target.getAttribute("disabled")?!0:!1;!this.shown&&!c&&(this._handlers.show?this._handlers.show.call(field,a,{done:this._proxy(this.show, this),hide:this._proxy(this.hide,this)}):this.show())},_keydown4field:function(a){switch(a.keyCode){case 9:case 16:case 17:case 18:case 20:case 27:case 37:case 38:case 39:case 224:return!0;case 40:this.shown||this.show();break;case 13:this.shown&&(a.preventDefault(),this.hide());break;default:!a.ctrlKey&&(!a.metaKey&&!this.shown)&&this.show(),this._timer&&clearTimeout(this._timer),this._timer=setTimeout(this._proxy(this._jump,this),500)}},_focus4field:function(a){var c=this._handlers;this.shown|| (c.show?c.show.call(field,a,{done:this._proxy(this.show,this),hide:this._proxy(this.hide,this)}):this.show())},_blur4field:function(){this.shown&&!this._hold&&this.hide();this._hold&&(this._hold=!1)},_mousemove4block:function(){this._timer&&clearTimeout(this._timer);this._hold=!0},_mouseout4block:function(){var a=this;this._timer=setTimeout(function(){a._hold=!1},150)},_click4block:function(a){var c=0,b=0,d=0,e=a.target,c=e.className,b=[];"b-cal__prev"==c?this.prev():"b-cal__next"==c?this.next(): "b-cal__hide"==c?this.hide():c.match("b-cal__day_is_enabled")?(c=e.getAttribute("data-day"),b=e.getAttribute("data-year"),d=e.getAttribute("data-month"),b={raw:new Date(b,d,c),field:this._nodes.field},b.human=g.human(b.raw),this._nodes.clicked.node=e,this._handlers.select?this._handlers.select.call(e,a,{hide:this._proxy(this._hide,this),done:this._proxy(this.select,this),reset:this._proxy(this.reset,this),undone:this._proxy(this.deselect,this)},b):this.select()):c.match("b-cal__day_is_chosen")&&(this._nodes.clicked.node= e,this._handlers.deselect?this._handlers.deselect.call(e,a,{done:this._proxy(this.deselect,this),hide:this._proxy(this._hide,this),reset:this._proxy(this.reset,this)}):this.deselect())},_tmpl:function(a,c){var c=c||{},a=a.replace(/\{\{ ?/g,"';out+=").replace(/ ?\}\}/g,";out+='").replace(/\{% if ?([^%]*) ?%\}/ig,"';if($1){out+='").replace(/\{% else ?%\}/ig,"';}else{out+='").replace(/\{% ?endif ?%\}/ig,"';}out+='"),b="",d="";for(d in c)b+=d+'=data["'+d+'"],';return eval(";(function(){var "+b+"out = '"+ a+"';return out;})();")},_indexof:function(a,c){if(!c||"object"!=typeof c)return-1;var b=0;if(c.indexOf)return c.indexOf(a);for(b in c)if(c[b]==a)return b;return-1},_bind:function(a,c,b){var d="",e="",f=this,g={alias:c,target:a,handler:function(a){a=f._eventize(a);b(a)}};a.addEventListener?e="addEventListener":a.attachEvent&&(d="on",e="attachEvent");a[e](d+c,g.handler);return g},_unbind:function(a,c,b){var d="",e="";a.removeEventListener?e="removeEventListener":a.detachEvent&&(d="on",e="detachEvent"); a[e](d+c,b)},_offsetize:function(a,c){var c=c||document.body,b=!1,d=/^t(?:able|d|h)$/i,e=document,f=e.body,g=e.defaultView?e.defaultView.getComputedStyle:null,h=a,i=g?g(h,null):h.currentStyle,j=null,l={top:h.offsetTop,left:h.offsetLeft,width:h.offsetWidth,height:h.offsetHeight},m=h.offsetParent;for(navigator.userAgent.match(/MSIE [67]/)&&"CSS1Compat"!=e.compatMode&&(b=!0);(h=h.parentNode)&&h!=c&&"fixed"!==i.position;)j=g?g(h,null):h.currentStyle,l.top-=h.scrollTop,l.left-=h.scrollLeft,h===m&&(l.top+= h.offsetTop,l.left+=h.offsetLeft,b&&d.test(h.tagName)&&(l.top+=parseFloat(j.borderTopWidth)||0,l.left+=parseFloat(j.borderLeftWidth)||0),m=h.offsetParent),"visible"!==j.overflow&&(l.top+=parseFloat(j.borderTopWidth)||0,l.left+=parseFLoat(j.borderLeftWidth)||0),i=j;h===f&&("relative"===i.position||"static"===i.position?(l.top+=f.offsetTop,l.left+=f.offsetLeft):"fixed"===i.position&&(l.top+=Math.max(e.scrollTop,f.scrollTop),l.left+=Math.max(e.scrollLeft,f.scrollLeft)));return l},_eventize:function(a){var a= a||window.event,c=navigator.userAgent.match(/opera/ig)?!0:!1,b=a.type;!c&&a.srcElement&&(a.target=a.srcElement);!c&&3==a.target.nodeType&&(a.target=a.target.parentNode);if(("keypress"==b||"keydown"==b||"keyup"==b)&&!a.keyCode&&a.which)a.keyCode=a.which;c||(a.relatedTarget||(a.relatedTarget=a.fromElement),a.stopPropagation||(a.stopPropagation=function(){this.cancelBubble=!0}),a.preventDefault||(a.preventDefault=function(){this.returnValue=!1}));return a},_proxy:function(a,c){return function(){return a.apply(c, arguments)}}};g.days=g.prototype.days;g.leap=g.prototype.leap;g.lang=g.prototype.lang;g.human=g.prototype.human;g.order=g.prototype.order;g.count=g.prototype.count;g.parse=g.prototype.parse;g.inside=g.prototype.inside;g.weekend=g.prototype.weekend;g.holiday=g.prototype.holiday;g.distance=g.prototype.distance;g.holidays=g.prototype.holidays;return g}();